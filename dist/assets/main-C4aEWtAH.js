var M=Object.defineProperty;var L=(n,t,e)=>t in n?M(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var f=(n,t,e)=>L(n,typeof t!="symbol"?t+"":t,e);import{U as B,s as u,r as R,a as j,b as I,c as P}from"./setInfo-eSbuLtId.js";import{F as S}from"./useValidation-3U9Cf16p.js";import{g as v,e as q,c as F,a as A,S as O}from"./swiper-BTdLKA9U.js";function C(n){const{effect:t,swiper:e,on:i,setTranslate:l,setTransition:c,overwriteParams:m,perspective:h,recreateShadows:s,getEffectParams:a}=n;i("beforeInit",()=>{if(e.params.effect!==t)return;e.classNames.push(`${e.params.containerModifierClass}${t}`),h&&h()&&e.classNames.push(`${e.params.containerModifierClass}3d`);const o=m?m():{};Object.assign(e.params,o),Object.assign(e.originalParams,o)}),i("setTranslate",()=>{e.params.effect===t&&l()}),i("setTransition",(o,d)=>{e.params.effect===t&&c(d)}),i("transitionEnd",()=>{if(e.params.effect===t&&s){if(!a||!a().slideShadows)return;e.slides.forEach(o=>{o.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(d=>d.remove())}),s()}});let r;i("virtualUpdate",()=>{e.params.effect===t&&(e.slides.length||(r=!0),requestAnimationFrame(()=>{r&&e.slides&&e.slides.length&&(l(),r=!1)}))})}function H(n,t){const e=v(t);return e!==t&&(e.style.backfaceVisibility="hidden",e.style["-webkit-backface-visibility"]="hidden"),e}function N(n){let{swiper:t,duration:e,transformElements:i,allSlides:l}=n;const{activeIndex:c}=t,m=h=>h.parentElement?h.parentElement:t.slides.find(a=>a.shadowRoot&&a.shadowRoot===h.parentNode);if(t.params.virtualTranslate&&e!==0){let h=!1,s;l?s=i:s=i.filter(a=>{const r=a.classList.contains("swiper-slide-transform")?m(a):a;return t.getSlideIndex(r)===c}),s.forEach(a=>{q(a,()=>{if(h||!t||t.destroyed)return;h=!0,t.animating=!1;const r=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0});t.wrapperEl.dispatchEvent(r)})})}}function T(n,t,e){const i=`swiper-slide-shadow${e?`-${e}`:""}${` swiper-slide-shadow-${n}`}`,l=v(t);let c=l.querySelector(`.${i.split(" ").join(".")}`);return c||(c=F("div",i.split(" ")),l.append(c)),c}function U(n){let{swiper:t,extendParams:e,on:i}=n;e({flipEffect:{slideShadows:!0,limitRotation:!0}});const l=(s,a)=>{let r=t.isHorizontal()?s.querySelector(".swiper-slide-shadow-left"):s.querySelector(".swiper-slide-shadow-top"),o=t.isHorizontal()?s.querySelector(".swiper-slide-shadow-right"):s.querySelector(".swiper-slide-shadow-bottom");r||(r=T("flip",s,t.isHorizontal()?"left":"top")),o||(o=T("flip",s,t.isHorizontal()?"right":"bottom")),r&&(r.style.opacity=Math.max(-a,0)),o&&(o.style.opacity=Math.max(a,0))};C({effect:"flip",swiper:t,on:i,setTranslate:()=>{const{slides:s,rtlTranslate:a}=t,r=t.params.flipEffect,o=A(t);for(let d=0;d<s.length;d+=1){const p=s[d];let w=p.progress;t.params.flipEffect.limitRotation&&(w=Math.max(Math.min(p.progress,1),-1));const y=p.swiperSlideOffset;let g=-180*w,z=0,E=t.params.cssMode?-y-t.translate:-y,b=0;t.isHorizontal()?a&&(g=-g):(b=E,E=0,z=-g,g=0),p.style.zIndex=-Math.abs(Math.round(w))+s.length,r.slideShadows&&l(p,w);const x=`translate3d(${E}px, ${b}px, 0px) rotateX(${o(z)}deg) rotateY(${o(g)}deg)`,k=H(r,p);k.style.transform=x}},setTransition:s=>{const a=t.slides.map(r=>v(r));a.forEach(r=>{r.style.transitionDuration=`${s}ms`,r.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(o=>{o.style.transitionDuration=`${s}ms`})}),N({swiper:t,duration:s,transformElements:a})},recreateShadows:()=>{t.params.flipEffect,t.slides.forEach(s=>{let a=s.progress;t.params.flipEffect.limitRotation&&(a=Math.max(Math.min(s.progress,1),-1)),l(s,a)})},getEffectParams:()=>t.params.flipEffect,perspective:()=>!0,overwriteParams:()=>({slidesPerView:1,slidesPerGroup:1,watchSlidesProgress:!0,spaceBetween:0,virtualTranslate:!t.params.cssMode})})}class V extends B{constructor(){super();f(this,"selectors",{authorization:"[data-js-authorization]",form:"[data-js-authorization-form]",input:"[data-js-authorization-input]",error:"[data-js-form-field-errors]",logIn:"[data-js-authorization-login]",registration:"[data-js-authorization-registration]",toRegistration:"[data-js-authorization-to-registration]",swiper:"[data-js-authorization-swiper]",slide:"[data-js-authorization-slide]"});f(this,"classes",{isActive:"is-active",loading:"loading"});f(this,"login",async()=>{u(this.logInBtn,this.loginBtnLoadingElement);let e=this.loginInputElements[0].value,i=this.loginInputElements[1].value;await this.logIn(e,i),u(this.logInBtn,this.loginBtnLoadingElement)});f(this,"registration",async()=>{try{if(u(this.regBtn,this.regBtnLoadingElement),await this.checkDoubleLogin(this.registrationInputElements[0].value)){let i={login:this.registrationInputElements[0].value,password:this.registrationInputElements[1].value,organization:this.registrationInputElements[2].value};(await R(i)).status===200?(j("Регистрация прошла успешно!!"),setTimeout(()=>{this.successLog(i)},2e3)):await I("Что-то пошло не так..")}else await I("Пользователь с таким логином уже существует!!"),u(this.regBtn,this.regBtnLoadingElement)}catch{await I("Что-то пошло не так.."),u(this.regBtn,this.regBtnLoadingElement)}});f(this,"clickToGoRegistration",()=>{this.swiperElement.slideTo(1)});f(this,"clearLogIn",()=>{this.loginErrorElements.each((e,i)=>{$(i).remove()}),this.clearInputs()});f(this,"clearInputs",()=>{this.inputElements.each((e,i)=>{$(i).val("")})});this.authorizationElement=$(this.selectors.authorization),this.formElements=this.authorizationElement.find(this.selectors.form),this.inputElements=this.authorizationElement.find(this.selectors.input),this.loginErrorElements=$(this.formElements[0]).find(this.selectors.error),this.loginInputElements=$(this.formElements[0]).find(this.selectors.input),this.registrationInputElements=$(this.formElements[1]).find(this.selectors.input),this.logInBtn=this.authorizationElement.find(this.selectors.logIn),this.regBtn=this.authorizationElement.find(this.selectors.registration),this.toRegBtn=this.authorizationElement.find(this.selectors.toRegistration),this.loginBtnLoadingElement=this.logInBtn.find(`.${this.classes.loading}`),this.regBtnLoadingElement=this.regBtn.find(`.${this.classes.loading}`),this.swiperElement=new O(this.selectors.swiper,{modules:[U],effect:"flip",allowTouchMove:!1}),this.loadFunctions(),this.bindEvents()}loadFunctions(){var l,c;this.clearInputs();let e=((l=JSON.parse(window.localStorage.getItem("user")))==null?void 0:l.login)??"",i=((c=JSON.parse(window.localStorage.getItem("user")))==null?void 0:c.password)??"";e.length&&i.length&&new B().logIn(e,i)}bindEvents(){this.toRegBtn.on("click",()=>{this.clickToGoRegistration(),this.clearLogIn()}),this.logInBtn.on("click",()=>{new S().onSubmit(this.formElements[0])&&this.login()}),this.regBtn.on("click",()=>{new S().onSubmit(this.formElements[1])&&this.registration()})}}P();new S;new V;
